# Discord бот для распознавания слова «блад»

Бот подключается к голосовому каналу, распознаёт речь через Vosk и отправляет сообщение, когда слышит любое слово из заданного списка. Для каждого срабатывания указывается участник, голосовой канал и фрагмент фразы (~1 с контекста).

## Возможности
- команды `!join`, `!stop`, `!leave`;
- распознавание на стороне бота (модель Vosk);
- отслеживание говорящего пользователя и упоминание в сообщении;
- настройка текста уведомления, списка слов, задержки между срабатываниями и длины контекстного окна.

## Требования
- Python 3.11+;
- установленный `ffmpeg`;
- модель Vosk (например, [vosk-model-small-ru-0.22](https://alphacephei.com/vosk/models));
- права бота на чтение голосовых каналов и отправку сообщений.

## Установка
```bash
python -m venv .venv
.venv\Scripts\activate          # Windows PowerShell
python -m pip install -U pip
pip install -r requirements.txt
```

Скачайте и распакуйте модель Vosk (папку `vosk-model-small-ru-0.22`) и укажите путь в `.env`.

## Настройка
1. Скопируйте пример конфигурации:
   ```bash
   copy .env.example .env
   ```
2. Заполните параметры:
   - `DISCORD_TOKEN` — токен бота;
   - `TARGET_WORDS` — слова через запятую (`блад,blad`);
   - `VOSK_MODEL_PATH` — путь к распакованной модели;
   - `DETECTION_MESSAGE` — шаблон сообщения. Доступные плейсхолдеры:
     - `{user}` — упоминание пользователя;
     - `{user_tag}` — «display name / username» или `ID <число>`;
     - `{channel}` — упоминание голосового канала либо его имя;
     - `{word}` — сработавшее слово;
     - `{transcript}` — фрагмент фразы (≈1 с вокруг слова);
   - `DETECTION_COOLDOWN_SECONDS` — минимальный интервал между срабатываниями для одного пользователя;
   - `DETECTION_CONTEXT_SECONDS` — ширина контекстного окна (в секундах).

## Запуск
```bash
python bot.py
```

В Discord:
1. Зайдите в голосовой канал.
2. В текстовом канале вызовите `!join`.
3. Произнесите ключевое слово — бот отправит сообщение с упоминанием говорившего.
4. `!stop` — остановить распознавание (бот остаётся в голосовом канале).
5. `!leave` — полностью отключить бота от канала.

## Примечания
- Распознавание выполняется локально, поэтому производительность зависит от вашей машины.
- Убедитесь, что использование бота соответствует правилам сервера и законодательству (запись голоса требует согласия участников).
